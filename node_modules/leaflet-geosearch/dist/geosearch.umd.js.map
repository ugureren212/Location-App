{"version":3,"file":"geosearch.umd.js","sources":["../src/domUtils.ts","../src/constants.ts","../src/SearchElement.ts","../src/resultList.ts","../src/lib/debounce.ts","../src/SearchControl.ts","../src/providers/provider.ts","../src/providers/algoliaProvider.ts","../src/providers/bingProvider.ts","../src/providers/esriProvider.ts","../src/providers/googleProvider.ts","../src/providers/hereProvider.ts","../src/providers/openStreetMapProvider.ts","../src/providers/locationIQProvider.ts","../src/providers/openCageProvider.ts"],"sourcesContent":["export function createElement<T extends HTMLElement = HTMLElement>(\n  element: string,\n  className: string | null = '',\n  parent?: Element | null,\n  attributes: { [key: string]: string | ((event: any) => void) } = {},\n): T {\n  const el = document.createElement(element) as T;\n\n  if (className) {\n    el.className = className;\n  }\n\n  Object.keys(attributes).forEach((key) => {\n    if (typeof attributes[key] === 'function') {\n      // IE doesn't support startsWith\n      const type = (key.indexOf('on') === 0\n        ? key.substr(2).toLowerCase()\n        : key) as keyof HTMLElementEventMap;\n      el.addEventListener(type, attributes[key] as () => void);\n    } else if (key === 'html') {\n      el.innerHTML = attributes[key] as string;\n    } else if (key === 'text') {\n      el.innerText = attributes[key] as string;\n    } else {\n      el.setAttribute(key, attributes[key] as string);\n    }\n  });\n\n  if (parent) {\n    parent.appendChild(el);\n  }\n\n  return el;\n}\n\nexport function stopPropagation(event: Event) {\n  event.preventDefault();\n  event.stopPropagation();\n}\n\nexport function createScriptElement<T = object>(\n  url: string,\n  cb: string,\n): Promise<T> {\n  const script = createElement('script', null, document.body);\n  script.setAttribute('type', 'text/javascript');\n\n  return new Promise((resolve) => {\n    (window as any)[cb] = (json: T): void => {\n      script.remove();\n      delete (window as any)[cb];\n      resolve(json);\n    };\n\n    script.setAttribute('src', url);\n  });\n}\n\nexport const cx = (...classNames: (string | undefined)[]): string =>\n  classNames.filter(Boolean).join(' ').trim();\n\nexport function addClassName(\n  element: Element | null,\n  className: string | string[],\n): void {\n  if (!element || !element.classList) {\n    return;\n  }\n\n  // IE doesn't support adding multiple classes at once :(\n  const classNames = Array.isArray(className) ? className : [className];\n  classNames.forEach((name) => {\n    if (!element.classList.contains(name)) {\n      element.classList.add(name);\n    }\n  });\n}\n\nexport function removeClassName(\n  element: Element | null,\n  className: string | string[],\n): void {\n  if (!element || !element.classList) {\n    return;\n  }\n\n  // IE doesn't support removing multiple classes at once :(\n  const classNames = Array.isArray(className) ? className : [className];\n  classNames.forEach((name) => {\n    if (element.classList.contains(name)) {\n      element.classList.remove(name);\n    }\n  });\n}\n\nexport function replaceClassName(\n  element: Element,\n  find: string,\n  replace: string,\n): void {\n  removeClassName(element, find);\n  addClassName(element, replace);\n}\n","export const ENTER_KEY = 13;\nexport const ESCAPE_KEY = 27;\nexport const ARROW_DOWN_KEY = 40;\nexport const ARROW_UP_KEY = 38;\nexport const ARROW_LEFT_KEY = 37;\nexport const ARROW_RIGHT_KEY = 39;\n\nexport const SPECIAL_KEYS = [\n  ENTER_KEY,\n  ESCAPE_KEY,\n  ARROW_DOWN_KEY,\n  ARROW_UP_KEY,\n  ARROW_LEFT_KEY,\n  ARROW_RIGHT_KEY,\n];\n","import {\n  createElement,\n  addClassName,\n  removeClassName,\n  cx,\n  stopPropagation,\n  replaceClassName,\n} from './domUtils';\n\nimport { ESCAPE_KEY, ENTER_KEY } from './constants';\n\ninterface SearchElementProps {\n  searchLabel?: string;\n  handleSubmit: (args: { query: string }) => void;\n  classNames?: {\n    container?: string;\n    form?: string;\n    input?: string;\n  };\n}\n\nexport default class SearchElement {\n  container: HTMLDivElement;\n  form: HTMLFormElement;\n  input: HTMLInputElement;\n  handleSubmit: (args: { query: string }) => void;\n  hasError = false;\n\n  constructor({\n    handleSubmit,\n    searchLabel,\n    classNames = {},\n  }: SearchElementProps) {\n    this.container = createElement<HTMLDivElement>(\n      'div',\n      cx('geosearch', classNames.container),\n    );\n\n    this.form = createElement<HTMLFormElement>(\n      'form',\n      ['', classNames.form].join(' '),\n      this.container,\n      {\n        autocomplete: 'none',\n        onClick: stopPropagation,\n        onDblClick: stopPropagation,\n        touchStart: stopPropagation,\n        touchEnd: stopPropagation,\n      },\n    );\n\n    this.input = createElement<HTMLInputElement>(\n      'input',\n      ['glass', classNames.input].join(' '),\n      this.form,\n      {\n        type: 'text',\n        placeholder: searchLabel || 'search',\n        onInput: this.onInput,\n        onKeyUp: (e) => this.onKeyUp(e),\n        onKeyPress: (e) => this.onKeyPress(e),\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n\n        // For some reason, leaflet is blocking the 'touchstart', manually give\n        // focus to the input onClick\n        // > Ignored attempt to cancel a touchstart event with cancelable=false,\n        // > for example because scrolling is in progress and cannot be interrupted.\n        onClick: () => {\n          this.input.focus();\n          this.input.dispatchEvent(new Event('focus'));\n        },\n      },\n    );\n\n    this.handleSubmit = handleSubmit;\n  }\n\n  onFocus(): void {\n    addClassName(this.form, 'active');\n  }\n\n  onBlur(): void {\n    removeClassName(this.form, 'active');\n  }\n\n  async onSubmit(event: Event): Promise<void> {\n    stopPropagation(event);\n    replaceClassName(this.container, 'error', 'pending');\n\n    await this.handleSubmit({ query: this.input.value });\n    removeClassName(this.container, 'pending');\n  }\n\n  onInput(): void {\n    if (!this.hasError) {\n      return;\n    }\n\n    removeClassName(this.container, 'error');\n    this.hasError = false;\n  }\n\n  onKeyUp(event: KeyboardEvent): void {\n    if (event.keyCode !== ESCAPE_KEY) {\n      return;\n    }\n\n    removeClassName(this.container, ['pending', 'active']);\n\n    this.input.value = '';\n\n    document.body.focus();\n    document.body.blur();\n  }\n\n  onKeyPress(event: KeyboardEvent): void {\n    if (event.keyCode !== ENTER_KEY) {\n      return;\n    }\n\n    this.onSubmit(event);\n  }\n\n  setQuery(query: string): void {\n    this.input.value = query;\n  }\n}\n","import { createElement, addClassName, removeClassName, cx } from './domUtils';\nimport { SearchResult } from './providers/provider';\n\ninterface ResultListProps {\n  handleClick: (args: { result: SearchResult }) => void;\n  classNames?: {\n    container?: string;\n    item?: string;\n  };\n}\n\nexport default class ResultList {\n  handleClick?: (args: { result: SearchResult }) => void;\n  selected = -1;\n  results: SearchResult[] = [];\n\n  container: HTMLDivElement;\n  resultItem: HTMLDivElement;\n\n  constructor({ handleClick, classNames = {} }: ResultListProps) {\n    this.handleClick = handleClick;\n\n    this.container = createElement<HTMLDivElement>(\n      'div',\n      cx('results', classNames.container),\n    );\n    this.container.addEventListener('click', this.onClick, true);\n\n    this.resultItem = createElement<HTMLDivElement>('div', cx(classNames.item));\n  }\n\n  render(results: SearchResult[] = [], resultFormat: Function): void {\n    this.clear();\n\n    results.forEach((result, idx) => {\n      const child = this.resultItem.cloneNode(true) as HTMLDivElement;\n      child.setAttribute('data-key', `${idx}`);\n      child.innerHTML = resultFormat({ result });\n      this.container.appendChild(child);\n    });\n\n    if (results.length > 0) {\n      addClassName(this.container.parentElement, 'open');\n      addClassName(this.container, 'active');\n    }\n\n    this.results = results;\n  }\n\n  select(index: number): SearchResult {\n    // eslint-disable-next-line no-confusing-arrow\n    Array.from(this.container.children).forEach((child, idx) =>\n      idx === index\n        ? addClassName(child, 'active')\n        : removeClassName(child, 'active'),\n    );\n\n    this.selected = index;\n    return this.results[index];\n  }\n\n  count(): number {\n    return this.results ? this.results.length : 0;\n  }\n\n  clear(): void {\n    this.selected = -1;\n\n    while (this.container.lastChild) {\n      this.container.removeChild(this.container.lastChild);\n    }\n\n    removeClassName(this.container.parentElement, 'open');\n    removeClassName(this.container, 'active');\n  }\n\n  onClick = (event: Event): void => {\n    if (typeof this.handleClick !== 'function') {\n      return;\n    }\n\n    const target = event.target as HTMLDivElement;\n    if (\n      !target ||\n      !this.container.contains(target) ||\n      !target.hasAttribute('data-key')\n    ) {\n      return;\n    }\n\n    const idx = Number(target.getAttribute('data-key'));\n    this.clear();\n    this.handleClick({ result: this.results[idx] });\n  };\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nexport default function debounce(\n  cb: (...args: any[]) => void,\n  wait = 250,\n  immediate = false,\n): (...args: any[]) => void {\n  let timeout: ReturnType<typeof setTimeout> | null;\n\n  return (...args: any[]): void => {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(() => {\n      timeout = null;\n\n      if (!immediate) {\n        cb(...args);\n      }\n    }, wait);\n\n    if (immediate && !timeout) {\n      cb(...args);\n    }\n  };\n}\n","import L, { ControlPosition, FeatureGroup, MarkerOptions, Map } from 'leaflet';\nimport SearchElement from './SearchElement';\nimport ResultList from './resultList';\nimport debounce from './lib/debounce';\n\nimport {\n  createElement,\n  addClassName,\n  removeClassName,\n  stopPropagation,\n} from './domUtils';\nimport {\n  ENTER_KEY,\n  SPECIAL_KEYS,\n  ARROW_UP_KEY,\n  ARROW_DOWN_KEY,\n  ESCAPE_KEY,\n} from './constants';\nimport AbstractProvider, { SearchResult } from './providers/provider';\nimport { Provider } from './providers';\n\nconst defaultOptions: Omit<SearchControlProps, 'provider'> = {\n  position: 'topleft',\n  style: 'button',\n  showMarker: true,\n  showPopup: false,\n  popupFormat: ({ result }) => `${result.label}`,\n  resultFormat: ({ result }) => `${result.label}`,\n  marker: {\n    icon: L && L.Icon ? new L.Icon.Default() : undefined,\n    draggable: false,\n  },\n  maxMarkers: 1,\n  maxSuggestions: 5,\n  retainZoomLevel: false,\n  animateZoom: true,\n  searchLabel: 'Enter address',\n  notFoundMessage: 'Sorry, that address could not be found.',\n  messageHideDelay: 3000,\n  zoomLevel: 18,\n  classNames: {\n    container: 'leaflet-bar leaflet-control leaflet-control-geosearch',\n    button: 'leaflet-bar-part leaflet-bar-part-single',\n    resetButton: 'reset',\n    msgbox: 'leaflet-bar message',\n    form: '',\n    input: '',\n  },\n  autoComplete: true,\n  autoCompleteDelay: 250,\n  autoClose: false,\n  keepResult: false,\n  updateMap: true,\n};\n\nconst UNINITIALIZED_ERR =\n  'Leaflet must be loaded before instantiating the GeoSearch control';\n\ninterface SearchControlProps {\n  /** the provider to use for searching */\n  provider: Provider;\n  /** the leaflet position to render the element in */\n  position: ControlPosition;\n  /**\n   * the stye of the search element\n   * @default bar\n   **/\n  style: 'button' | 'bar';\n\n  marker: MarkerOptions;\n  maxMarkers: number;\n  showMarker: boolean;\n  showPopup: boolean;\n  popupFormat<T = any>(args: {\n    query: Selection;\n    result: SearchResult<T>;\n  }): string;\n\n  resultFormat<T = any>(args: { result: SearchResult<T> }): string;\n\n  searchLabel: string;\n  notFoundMessage: string;\n  messageHideDelay: number;\n\n  animateZoom: boolean;\n  zoomLevel: number;\n  retainZoomLevel: boolean;\n\n  classNames: {\n    container: string;\n    button: string;\n    resetButton: string;\n    msgbox: string;\n    form: string;\n    input: string;\n  };\n\n  autoComplete: boolean;\n  autoCompleteDelay: number;\n  maxSuggestions: number;\n  autoClose: boolean;\n  keepResult: boolean;\n  updateMap: boolean;\n}\n\nexport type SearchControlOptions = Partial<SearchControlProps> & {\n  provider: Provider;\n};\n\ninterface Selection {\n  query: string;\n  data?: SearchResult;\n}\n\ninterface SearchControl {\n  options: Omit<SearchControlProps, 'provider'> & {\n    provider?: SearchControlProps['provider'];\n  };\n  markers: FeatureGroup;\n  searchElement: SearchElement;\n  resultList: ResultList;\n  classNames: SearchControlProps['classNames'];\n  container: HTMLDivElement;\n  input: HTMLInputElement;\n  button: HTMLAnchorElement;\n  resetButton: HTMLAnchorElement;\n  map: Map;\n\n  // [key: string]: any;\n  initialize(options: SearchControlProps): void;\n  onSubmit(result: Selection): void;\n  onClick(event: Event): void;\n  clearResults(event?: KeyboardEvent | null, force?: boolean): void;\n  autoSearch(event: KeyboardEvent): void;\n  selectResult(event: KeyboardEvent): void;\n  showResult(result: SearchResult, query: Selection): void;\n  addMarker(result: SearchResult, selection: Selection): void;\n  centerMap(result: SearchResult): void;\n  closeResults(): void;\n  getZoom(): number;\n  onAdd(map: Map): HTMLDivElement;\n  onRemove(): SearchControl;\n}\n\n// @ts-ignore\nconst Control: SearchControl = {\n  options: { ...defaultOptions },\n  classNames: { ...defaultOptions.classNames },\n\n  initialize(options: SearchControlOptions) {\n    if (!L) {\n      throw new Error(UNINITIALIZED_ERR);\n    }\n\n    if (!options.provider) {\n      throw new Error('Provider is missing from options');\n    }\n\n    // merge given options with control defaults\n    this.options = { ...this.options, ...options };\n    this.classNames = { ...this.classNames, ...options.classNames };\n\n    this.markers = new L.FeatureGroup();\n    this.classNames.container += ` leaflet-geosearch-${this.options.style}`;\n\n    this.searchElement = new SearchElement({\n      searchLabel: this.options.searchLabel,\n      classNames: {\n        container: this.classNames.container,\n        form: this.classNames.form,\n        input: this.classNames.input,\n      },\n      handleSubmit: (result) => this.onSubmit(result),\n    });\n\n    this.button = createElement<HTMLAnchorElement>(\n      'a',\n      this.classNames.button,\n      this.searchElement.container,\n      {\n        title: this.options.searchLabel,\n        href: '#',\n        onClick: (e) => this.onClick(e),\n      },\n    );\n\n    L.DomEvent.disableClickPropagation(this.button);\n\n    this.resetButton = createElement<HTMLAnchorElement>(\n      'a',\n      this.classNames.resetButton,\n      this.searchElement.form,\n      {\n        text: 'Ã—',\n        href: '#',\n        onClick: () => this.clearResults(null, true),\n      },\n    );\n\n    L.DomEvent.disableClickPropagation(this.resetButton);\n\n    if (this.options.autoComplete) {\n      this.resultList = new ResultList({\n        handleClick: ({ result }): void => {\n          this.searchElement.input.value = result.label;\n          this.onSubmit({ query: result.label, data: result });\n        },\n      });\n\n      this.searchElement.form.appendChild(this.resultList.container);\n\n      this.searchElement.input.addEventListener(\n        'keyup',\n        debounce(\n          (e: KeyboardEvent) => this.autoSearch(e),\n          this.options.autoCompleteDelay,\n        ),\n        true,\n      );\n\n      this.searchElement.input.addEventListener(\n        'keydown',\n        (e: KeyboardEvent) => this.selectResult(e),\n        true,\n      );\n\n      this.searchElement.input.addEventListener(\n        'keydown',\n        (e: KeyboardEvent) => this.clearResults(e, true),\n        true,\n      );\n    }\n\n    this.searchElement.form.addEventListener(\n      'click',\n      (e) => {\n        e.preventDefault();\n      },\n      false,\n    );\n  },\n\n  onAdd(map: Map) {\n    const { showMarker, style } = this.options;\n\n    this.map = map;\n    if (showMarker) {\n      this.markers.addTo(map);\n    }\n\n    if (style === 'bar') {\n      const root = map\n        .getContainer()\n        .querySelector('.leaflet-control-container');\n\n      this.container = createElement<HTMLDivElement>(\n        'div',\n        'leaflet-control-geosearch leaflet-geosearch-bar',\n      );\n\n      this.container.appendChild(this.searchElement.form);\n      root!.appendChild(this.container);\n    }\n\n    L.DomEvent.disableClickPropagation(this.searchElement.form);\n    return this.searchElement.container;\n  },\n\n  onRemove() {\n    this.container?.remove();\n    return this;\n  },\n\n  onClick(event: Event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const { container, input } = this.searchElement;\n\n    if (container.classList.contains('active')) {\n      removeClassName(container, 'active');\n      this.clearResults();\n    } else {\n      addClassName(container, 'active');\n      input.focus();\n    }\n  },\n\n  selectResult(event) {\n    if (\n      [ENTER_KEY, ARROW_DOWN_KEY, ARROW_UP_KEY].indexOf(event.keyCode) === -1\n    ) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (event.keyCode === ENTER_KEY) {\n      const item = this.resultList.select(this.resultList.selected);\n      this.onSubmit({ query: this.searchElement.input.value, data: item });\n      return;\n    }\n\n    const max = this.resultList.count() - 1;\n    if (max < 0) {\n      return;\n    }\n\n    const { selected } = this.resultList;\n    const next = event.keyCode === ARROW_DOWN_KEY ? selected + 1 : selected - 1;\n    const idx = next < 0 ? max : next > max ? 0 : next;\n\n    const item = this.resultList.select(idx);\n    this.searchElement.input.value = item.label;\n  },\n\n  clearResults(event: KeyboardEvent | null, force = false) {\n    if (event && event.keyCode !== ESCAPE_KEY) {\n      return;\n    }\n\n    const { keepResult, autoComplete } = this.options;\n\n    if (force || !keepResult) {\n      this.searchElement.input.value = '';\n      this.markers.clearLayers();\n    }\n\n    if (autoComplete) {\n      this.resultList.clear();\n    }\n  },\n\n  async autoSearch(event) {\n    if (SPECIAL_KEYS.indexOf(event.keyCode) > -1) {\n      return;\n    }\n\n    const query = (event.target as HTMLInputElement).value;\n    const { provider } = this.options;\n\n    if (query.length) {\n      let results = await provider!.search({ query });\n      results = results.slice(0, this.options.maxSuggestions);\n      this.resultList.render(results, this.options.resultFormat);\n    } else {\n      this.resultList.clear();\n    }\n  },\n\n  async onSubmit(query) {\n    const { provider } = this.options;\n\n    const results = await provider!.search(query);\n\n    if (results && results.length > 0) {\n      this.showResult(results[0], query);\n    }\n  },\n\n  showResult(result, query) {\n    const { autoClose, updateMap } = this.options;\n\n    const markers = this.markers.getLayers();\n    if (markers.length >= this.options.maxMarkers) {\n      this.markers.removeLayer(markers[0]);\n    }\n\n    const marker = this.addMarker(result, query);\n\n    if (updateMap) {\n      this.centerMap(result);\n    }\n\n    this.map.fireEvent('geosearch/showlocation', {\n      location: result,\n      marker,\n    });\n\n    if (autoClose) {\n      this.closeResults();\n    }\n  },\n\n  closeResults() {\n    const { container } = this.searchElement;\n\n    if (container.classList.contains('active')) {\n      removeClassName(container, 'active');\n    }\n\n    this.clearResults();\n  },\n\n  addMarker(result, query) {\n    const { marker: options, showPopup, popupFormat } = this.options;\n    const marker = new L.Marker([result.y, result.x], options);\n    let popupLabel = result.label;\n\n    if (typeof popupFormat === 'function') {\n      popupLabel = popupFormat({ query, result });\n    }\n\n    marker.bindPopup(popupLabel);\n\n    this.markers.addLayer(marker);\n\n    if (showPopup) {\n      marker.openPopup();\n    }\n\n    if (options.draggable) {\n      marker.on('dragend', (args) => {\n        this.map.fireEvent('geosearch/marker/dragend', {\n          location: marker.getLatLng(),\n          event: args,\n        });\n      });\n    }\n\n    return marker;\n  },\n\n  centerMap(result) {\n    const { retainZoomLevel, animateZoom } = this.options;\n\n    const resultBounds = result.bounds\n      ? new L.LatLngBounds(result.bounds)\n      : new L.LatLng(result.y, result.x).toBounds(10);\n\n    const bounds = resultBounds.isValid()\n      ? resultBounds\n      : this.markers.getBounds();\n\n    if (!retainZoomLevel && resultBounds.isValid()) {\n      this.map.fitBounds(bounds, { animate: animateZoom });\n    } else {\n      this.map.setView(bounds.getCenter(), this.getZoom(), {\n        animate: animateZoom,\n      });\n    }\n  },\n\n  getZoom(): number {\n    const { retainZoomLevel, zoomLevel } = this.options;\n    return retainZoomLevel ? this.map.getZoom() : zoomLevel;\n  },\n};\n\nexport default function SearchControl(...options: any[]) {\n  if (!L) {\n    throw new Error(UNINITIALIZED_ERR);\n  }\n\n  const LControl = L.Control.extend(Control);\n  return new LControl(...options);\n}\n","export type PointTuple = [number, number];\nexport type BoundsTuple = [PointTuple, PointTuple];\n\nexport interface LatLng {\n  lat: number;\n  lng: number;\n}\n\nexport interface SearchResult<TRawResult = any> {\n  x: number;\n  y: number;\n  label: string;\n  bounds: BoundsTuple | null;\n  raw: TRawResult;\n}\n\nexport interface ProviderParams {\n  [key: string]: string | number | boolean;\n}\n\nexport interface ProviderOptions {\n  params?: ProviderParams;\n}\n\nexport enum RequestType {\n  SEARCH,\n  REVERSE,\n}\n\nexport interface EndpointArgument {\n  query: string | { [key: string]: string | number | boolean };\n  type?: RequestType;\n}\n\nexport interface SearchArgument {\n  query: string;\n}\n\nexport interface ParseArgument<TData> {\n  data: TData;\n}\n\nexport interface Provider<TRequestResult, TRawResult> {\n  options: ProviderOptions;\n\n  endpoint(options: EndpointArgument): string;\n  getParamString(params: ProviderParams): string;\n  parse(response: ParseArgument<TRequestResult>): SearchResult<TRawResult>[];\n  search(options: SearchArgument): Promise<SearchResult<TRawResult>[]>;\n}\n\nexport default abstract class AbstractProvider<\n  TRequestResult = any,\n  TRawResult = any\n> implements Provider<TRequestResult, TRawResult> {\n  options: ProviderOptions;\n\n  constructor(options: ProviderOptions = {}) {\n    this.options = options;\n  }\n\n  abstract endpoint(options: EndpointArgument): string;\n  abstract parse(\n    response: ParseArgument<TRequestResult>,\n  ): SearchResult<TRawResult>[];\n\n  getParamString(params: ProviderParams = {}): string {\n    const set = { ...this.options.params, ...params };\n    return Object.keys(set)\n      .map(\n        (key) => `${encodeURIComponent(key)}=${encodeURIComponent(set[key])}`,\n      )\n      .join('&');\n  }\n\n  getUrl(url: string, params?: ProviderParams): string {\n    return `${url}?${this.getParamString(params)}`;\n  }\n\n  async search(options: SearchArgument): Promise<SearchResult<TRawResult>[]> {\n    const url = this.endpoint({\n      query: options.query,\n      type: RequestType.SEARCH,\n    });\n\n    const request = await fetch(url);\n    const json: TRequestResult = await request.json();\n    return this.parse({ data: json });\n  }\n}\n","import AbstractProvider, {\n  LatLng,\n  ParseArgument,\n  SearchArgument,\n  SearchResult,\n} from './provider';\n\ninterface RequestResult {\n  hits: RawResult[];\n}\n\ninterface ValueMatch {\n  value: string;\n  matchLevel: string;\n  matchedWords: string[];\n  fullyHighlighted?: boolean;\n}\n\ninterface RawResult {\n  country: { [key: string]: string };\n  country_code: string;\n  city: { [key: string]: string[] };\n  importance: number;\n  _tags: string[];\n  postcode: string[];\n  population: number;\n  is_country: boolean;\n  is_highway: boolean;\n  is_city: boolean;\n  is_popular: boolean;\n  administrative: string[];\n  admin_level: number;\n  is_suburb: boolean;\n  locale_names: {\n    default: string[];\n  };\n  _geoloc: LatLng;\n  objectID: string;\n  _highlightResult: {\n    country: {\n      default: ValueMatch;\n      [key: string]: ValueMatch;\n    };\n    city: {\n      default: ValueMatch[];\n      [key: string]: ValueMatch[];\n    };\n    postcode: ValueMatch[];\n    administrative: ValueMatch[];\n    locale_names: {\n      default: ValueMatch[];\n    };\n  };\n}\n\ninterface ProviderOptions {\n  key?: string;\n  [key: string]: string | boolean | number | undefined;\n}\n\nexport default class Provider extends AbstractProvider<\n  RequestResult,\n  RawResult\n> {\n  endpoint(): string {\n    // No query, Algolia requires POST request\n    return 'https://places-dsn.algolia.net/1/places/query';\n  }\n\n  /**\n   * Find index of value with best match\n   * (full, fallback to partial, and then to 0)\n   */\n  findBestMatchLevelIndex(vms: ValueMatch[]): number {\n    const match =\n      vms.find((vm) => vm.matchLevel === 'full') ||\n      vms.find((vm) => vm.matchLevel === 'partial');\n    return match ? vms.indexOf(match) : 0;\n  }\n\n  /**\n   * Algolia not provides labels for hits, so\n   * we will implement that builder ourselves\n   */\n  getLabel(result: RawResult): string {\n    return [\n      // Building + Street\n      result.locale_names?.default[\n        this.findBestMatchLevelIndex(\n          result._highlightResult.locale_names.default,\n        )\n      ],\n      // City\n      result.city?.default[\n        this.findBestMatchLevelIndex(result._highlightResult.city.default)\n      ],\n      // Administrative (State / Province)\n      result.administrative[\n        this.findBestMatchLevelIndex(result._highlightResult.administrative)\n      ],\n      // Zip code / Postal code\n      result.postcode?.[\n        this.findBestMatchLevelIndex(result._highlightResult.postcode)\n      ],\n      // Country\n      result.country?.default,\n    ]\n      .filter(Boolean)\n      .join(', ');\n  }\n\n  parse(response: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    return response.data.hits.map((r) => ({\n      x: r._geoloc.lng,\n      y: r._geoloc.lat,\n      label: this.getLabel(r),\n      bounds: null, // Algolia API does not provide bounds\n      raw: r,\n    }));\n  }\n\n  async search({ query }: SearchArgument): Promise<SearchResult<RawResult>[]> {\n    const params = typeof query === 'string' ? { query } : query;\n\n    const request = await fetch(this.endpoint(), {\n      method: 'POST',\n      body: JSON.stringify({\n        ...this.options.params,\n        ...params,\n      }),\n    });\n\n    const json = await request.json();\n    return this.parse({ data: json });\n  }\n}\n","import AbstractProvider, {\n  EndpointArgument,\n  ParseArgument,\n  SearchArgument,\n  SearchResult,\n} from './provider';\nimport { createScriptElement } from '../domUtils';\n\nexport interface RequestResult {\n  authenticationResultCode: string;\n  brandLogoUri: string;\n  copyright: string;\n  resourceSets: {\n    estimatedTotal: number;\n    resources: RawResult[];\n  }[];\n  statusCode: number;\n  statusDescription: string;\n  traceId: string;\n}\n\nexport interface RawResult {\n  __type: string;\n  bbox: [number, number, number, number];\n  name: string;\n  point: { type: 'Point'; coordinates: [number, number] };\n  address: {\n    adminDistrict: string;\n    adminDistrict2: string;\n    countryRegion: string;\n    formattedAddress: string;\n    locality: string;\n  };\n  confidence: string;\n  entityType: string;\n  geocodePoints: [\n    {\n      type: 'Point';\n      coordinates: [number, number];\n      calculationMethod: string;\n      usageTypes: string[];\n    },\n  ];\n  matchCodes: string[];\n}\n\nexport default class BingProvider extends AbstractProvider<\n  RequestResult,\n  RawResult\n> {\n  searchUrl = 'https://dev.virtualearth.net/REST/v1/Locations';\n\n  endpoint({ query, jsonp }: EndpointArgument & { jsonp: string }): string {\n    const params = typeof query === 'string' ? { q: query } : query;\n    params.jsonp = jsonp;\n\n    return this.getUrl(this.searchUrl, params);\n  }\n\n  parse(response: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    if (response.data.resourceSets.length === 0) {\n      return [];\n    }\n\n    return response.data.resourceSets[0].resources.map((r) => ({\n      x: r.point.coordinates[1],\n      y: r.point.coordinates[0],\n      label: r.address.formattedAddress,\n      bounds: [\n        [r.bbox[0], r.bbox[1]], // s, w\n        [r.bbox[2], r.bbox[3]], // n, e\n      ],\n      raw: r,\n    }));\n  }\n\n  async search({ query }: SearchArgument): Promise<SearchResult<RawResult>[]> {\n    const jsonp = `BING_JSONP_CB_${Date.now()}`;\n    const json = await createScriptElement<RequestResult>(\n      this.endpoint({ query, jsonp }),\n      jsonp,\n    );\n\n    return this.parse({ data: json });\n  }\n}\n","import AbstractProvider, {\n  EndpointArgument,\n  ParseArgument,\n  SearchResult,\n} from './provider';\n\ninterface RequestResult {\n  spatialReference: { wkid: number; latestWkid: number };\n  locations: RawResult[];\n}\n\ninterface RawResult {\n  name: string;\n  extent: {\n    xmin: number;\n    ymin: number;\n    xmax: number;\n    ymax: number;\n  };\n  feature: {\n    geometry: { x: number; y: number };\n    attributes: { Score: number; Addr_Type: string };\n  };\n}\n\nexport default class EsriProvider extends AbstractProvider<\n  RequestResult,\n  RawResult\n> {\n  searchUrl =\n    'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find';\n\n  endpoint({ query }: EndpointArgument): string {\n    const params = typeof query === 'string' ? { text: query } : query;\n    params.f = 'json';\n\n    return this.getUrl(this.searchUrl, params);\n  }\n\n  parse(result: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    return result.data.locations.map((r) => ({\n      x: r.feature.geometry.x,\n      y: r.feature.geometry.y,\n      label: r.name,\n      bounds: [\n        [r.extent.ymin, r.extent.xmin], // s, w\n        [r.extent.ymax, r.extent.xmax], // n, e\n      ],\n      raw: r,\n    }));\n  }\n}\n","import AbstractProvider, {\n  EndpointArgument,\n  LatLng,\n  ParseArgument,\n  SearchResult,\n} from './provider';\n\nexport interface RequestResult {\n  results: RawResult[];\n  status: string;\n}\n\nexport interface RawResult {\n  address_components: {\n    long_name: string;\n    short_name: string;\n    types: string[];\n  }[];\n  formatted_address: string;\n  geometry: {\n    location: LatLng;\n    location_type: string;\n    viewport: {\n      northeast: LatLng;\n      southwest: LatLng;\n    };\n  };\n  place_id: string;\n  plus_code: {\n    compound_code: string;\n    global_code: string;\n  };\n  types: string[];\n}\n\nexport default class GoogleProvider extends AbstractProvider<\n  RequestResult,\n  RawResult\n> {\n  searchUrl = 'https://maps.googleapis.com/maps/api/geocode/json';\n\n  endpoint({ query }: EndpointArgument) {\n    const params = typeof query === 'string' ? { address: query } : query;\n    return this.getUrl(this.searchUrl, params);\n  }\n\n  parse(result: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    return result.data.results.map((r) => ({\n      x: r.geometry.location.lng,\n      y: r.geometry.location.lat,\n      label: r.formatted_address,\n      bounds: [\n        [r.geometry.viewport.southwest.lat, r.geometry.viewport.southwest.lng], // s, w\n        [r.geometry.viewport.northeast.lat, r.geometry.viewport.northeast.lng], // n, e\n      ],\n      raw: r,\n    }));\n  }\n}\n","import AbstractProvider, {\n  EndpointArgument,\n  LatLng,\n  ParseArgument,\n  SearchResult,\n} from './provider';\n\nexport interface RequestResult {\n  items: RawResult[];\n}\n\nexport interface RawResult {\n  title: string;\n  id: string;\n  resultType: string;\n  address: {\n    label: string;\n    countryCode: string;\n    countryName: string;\n    state: string;\n    county: string;\n    city: string;\n    district: string;\n    street: string;\n    postalCode: string;\n    houseNumber: string;\n  };\n  position: LatLng;\n  access: LatLng[];\n  categories: { id: string }[];\n  contacts: { [key: string]: { value: string }[] }[];\n  scoring: {\n    queryScore: number;\n    fieldScore: {\n      placeName: number;\n    };\n  };\n}\n\nexport default class HereProvider extends AbstractProvider<\n  RequestResult,\n  RawResult\n> {\n  searchUrl = 'https://geocode.search.hereapi.com/v1/geocode';\n\n  endpoint({ query }: EndpointArgument): string {\n    const params = typeof query === 'string' ? { q: query } : query;\n    return this.getUrl(this.searchUrl, params);\n  }\n\n  parse(response: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    return response.data.items.map((r) => ({\n      x: r.position.lng,\n      y: r.position.lat,\n      label: r.address.label,\n      bounds: null,\n      raw: r,\n    }));\n  }\n}\n","/* eslint-disable @typescript-eslint/camelcase */\nimport AbstractProvider, {\n  EndpointArgument,\n  ParseArgument,\n  ProviderOptions,\n  RequestType,\n  SearchResult,\n} from './provider';\nimport hasShape from '../lib/hasShape';\n\nexport type RequestResult = RawResult[];\n\nexport interface RawResult {\n  place_id: string;\n  license: string;\n  osm_type: string;\n  osm_id: number;\n  boundingbox: [string, string, string, string];\n  lat: string;\n  lon: string;\n  display_name: string;\n  class: string;\n  type: string;\n  importance: number;\n  icon?: string;\n}\n\nexport type OpenStreetMapProviderOptions = {\n  searchUrl?: string;\n  reverseUrl?: string;\n} & ProviderOptions;\n\nexport default class OpenStreetMapProvider extends AbstractProvider<\n  RawResult[],\n  RawResult\n> {\n  searchUrl: string;\n  reverseUrl: string;\n\n  constructor(options: OpenStreetMapProviderOptions = {}) {\n    super(options);\n\n    const host = 'https://nominatim.openstreetmap.org';\n    this.searchUrl = options.searchUrl || `${host}/search`;\n    this.reverseUrl = options.reverseUrl || `${host}/reverse`;\n  }\n\n  endpoint({ query, type }: EndpointArgument): string {\n    const params = typeof query === 'string' ? { q: query } : query;\n    params.format = 'json';\n\n    switch (type) {\n      case RequestType.REVERSE:\n        return this.getUrl(this.reverseUrl, params);\n\n      default:\n        return this.getUrl(this.searchUrl, params);\n    }\n  }\n\n  parse(response: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    const records = Array.isArray(response.data)\n      ? response.data\n      : [response.data];\n\n    return records.map((r) => ({\n      x: Number(r.lon),\n      y: Number(r.lat),\n      label: r.display_name,\n      bounds: [\n        [parseFloat(r.boundingbox[0]), parseFloat(r.boundingbox[2])], // s, w\n        [parseFloat(r.boundingbox[1]), parseFloat(r.boundingbox[3])], // n, e\n      ],\n      raw: r,\n    }));\n  }\n}\n","import OpenStreetMapProvider, {\n  OpenStreetMapProviderOptions,\n} from './openStreetMapProvider';\n\nexport default class LocationIQProvider extends OpenStreetMapProvider {\n  constructor(options: OpenStreetMapProviderOptions) {\n    super({\n      ...options,\n      searchUrl: `https://locationiq.org/v1/search.php`,\n      reverseUrl: `https://locationiq.org/v1/reverse.php`,\n    });\n  }\n}\n","import AbstractProvider, {\n  EndpointArgument,\n  LatLng,\n  ParseArgument,\n  SearchArgument,\n  SearchResult,\n} from './provider';\n\nexport interface RequestResult {\n  results: RawResult[];\n}\n\nexport interface RawResult {\n  annotations: {\n    DMS: { lat: string; lng: string };\n    MGRS: string;\n    Maidenhead: string;\n    Mercator: { x: number; y: number };\n    OSM: {\n      edit_url: string;\n      note_url: string;\n      url: string;\n    };\n    UN_M49: {\n      regions: { [key: string]: string };\n      statistical_groupings: string[];\n    };\n    callingcode: number;\n    currency: {\n      alternate_symbols: string[];\n      decimal_mark: string;\n      html_entity: string;\n      iso_code: string;\n      iso_numeric: string;\n      name: string;\n      smallest_denomination: number;\n      subunit: string;\n      subunit_to_unit: number;\n      symbol: string;\n      symbol_first: number;\n      thousands_separator: string;\n    };\n    flag: string;\n    geohash: string;\n    qibla: number;\n    roadinfo: {\n      drive_on: string;\n      road: string;\n      road_type: string;\n      speed_in: string;\n    };\n    sun: {\n      rise: {\n        apparent: number;\n        astronomical: number;\n        civil: number;\n        nautical: number;\n      };\n      set: {\n        apparent: number;\n        astronomical: number;\n        civil: number;\n        nautical: number;\n      };\n    };\n    timezone: {\n      name: string;\n      now_in_dst: number;\n      offset_sec: number;\n      offset_string: string;\n      short_name: string;\n    };\n    what3words: { words: string };\n  };\n  bounds: {\n    northeast: LatLng;\n    southwest: LatLng;\n  };\n  formatted: string;\n  geometry: LatLng;\n}\n\nexport default class OpenCageProvider extends AbstractProvider<\n  RequestResult,\n  RawResult\n> {\n  searchUrl = 'https://api.opencagedata.com/geocode/v1/json';\n\n  endpoint({ query }: EndpointArgument) {\n    const params = typeof query === 'string' ? { q: query } : query;\n    params.format = 'json';\n\n    return this.getUrl(this.searchUrl, params);\n  }\n\n  parse(response: ParseArgument<RequestResult>): SearchResult<RawResult>[] {\n    return response.data.results.map((r) => ({\n      x: r.geometry.lng,\n      y: r.geometry.lat,\n      label: r.formatted,\n      bounds: [\n        [r.bounds.southwest.lat, r.bounds.southwest.lng], // s, w\n        [r.bounds.northeast.lat, r.bounds.northeast.lng], // n, e\n      ],\n      raw: r,\n    }));\n  }\n\n  async search(options: SearchArgument): Promise<SearchResult<RawResult>[]> {\n    // opencage returns a 400 error when query length < 2\n    if (options.query.length < 2) {\n      return [];\n    }\n\n    return super.search(options);\n  }\n}\n"],"names":["createElement","element","className","parent","attributes","el","document","Object","keys","forEach","key","type","indexOf","substr","toLowerCase","addEventListener","innerHTML","innerText","setAttribute","appendChild","stopPropagation","event","preventDefault","createScriptElement","url","cb","script","body","Promise","resolve","window","json","remove","cx","classNames","filter","Boolean","join","trim","addClassName","classList","Array","isArray","name","contains","add","removeClassName","replaceClassName","find","replace","ENTER_KEY","ESCAPE_KEY","ARROW_DOWN_KEY","ARROW_UP_KEY","ARROW_LEFT_KEY","ARROW_RIGHT_KEY","SPECIAL_KEYS","SearchElement","handleSubmit","searchLabel","container","form","autocomplete","onClick","onDblClick","touchStart","touchEnd","input","placeholder","onInput","onKeyUp","e","onKeyPress","onFocus","onBlur","focus","dispatchEvent","Event","onSubmit","query","value","hasError","keyCode","blur","setQuery","ResultList","handleClick","target","hasAttribute","idx","Number","getAttribute","clear","result","results","resultItem","item","render","resultFormat","child","cloneNode","length","parentElement","select","index","from","children","selected","count","lastChild","removeChild","debounce","wait","immediate","timeout","args","clearTimeout","setTimeout","defaultOptions","position","style","showMarker","showPopup","popupFormat","label","marker","icon","L","Icon","Default","undefined","draggable","maxMarkers","maxSuggestions","retainZoomLevel","animateZoom","notFoundMessage","messageHideDelay","zoomLevel","button","resetButton","msgbox","autoComplete","autoCompleteDelay","autoClose","keepResult","updateMap","UNINITIALIZED_ERR","Control","options","initialize","Error","provider","markers","FeatureGroup","searchElement","title","href","DomEvent","disableClickPropagation","text","clearResults","resultList","data","autoSearch","selectResult","onAdd","map","addTo","root","getContainer","querySelector","onRemove","max","next","force","clearLayers","search","slice","showResult","getLayers","removeLayer","addMarker","centerMap","fireEvent","location","closeResults","Marker","y","x","popupLabel","bindPopup","addLayer","openPopup","on","getLatLng","resultBounds","bounds","LatLngBounds","LatLng","toBounds","isValid","getBounds","fitBounds","animate","setView","getCenter","getZoom","SearchControl","LControl","extend","RequestType","AbstractProvider","getParamString","params","set","encodeURIComponent","getUrl","endpoint","SEARCH","fetch","request","parse","Provider","findBestMatchLevelIndex","vms","match","vm","matchLevel","getLabel","locale_names","_highlightResult","city","administrative","postcode","country","response","hits","r","_geoloc","lng","lat","raw","method","JSON","stringify","BingProvider","jsonp","q","searchUrl","resourceSets","resources","point","coordinates","address","formattedAddress","bbox","Date","now","EsriProvider","f","locations","feature","geometry","extent","ymin","xmin","ymax","xmax","GoogleProvider","formatted_address","viewport","southwest","northeast","HereProvider","items","OpenStreetMapProvider","host","reverseUrl","format","REVERSE","records","lon","display_name","parseFloat","boundingbox","LocationIQProvider","OpenCageProvider","formatted"],"mappings":"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"}